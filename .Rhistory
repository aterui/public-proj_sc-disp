# Plot ----
pdf("figure_dispersal_Indian_ver2.pdf", 6, 6)
par(mfrow = c(3, 3), mar = c(1,2,1,0), oma=c(5,5,2,1))
for(i in 1:3){
# Select species
SP <- Species[i]
dd <- dat[dat$Species==SP,]
# Scale body size with mean 0 SD 0.5
scl.size <- scale(dd$Size1, scale = sd(dd$Size1)*2)
Q.scl.size <- quantile(scl.size, c(0.2,0.5,0.8), na.rm = T)
# Unscaled body size
Q.unscl.size <- quantile(dd$Size1, c(0.2,0.5,0.8), na.rm = T)
# parameters
est <- read.csv(paste0("result/summary_8000", SP, "2019-11-20Q99.csv") )
b1 <- est[which(est$X=="b[1]"),"X50."] # Intercept
b2 <- est[which(est$X=="b[2]"),"X50."] # Flow
b3 <- est[which(est$X=="b[3]"),"X50."] # Size
b4 <- est[which(est$X=="b[4]"),"X50."] # Flow*Size
b6 <- est[which(est$X=="b[6]"),"X50."] # Stream
# rate parameter
lambda0 <- sapply(Q.scl.size, function(x) 1/exp(b1 + b2*0 + (b3 + b4*0)*x + b6*0) )
lambda1 <- sapply(Q.scl.size, function(x) 1/exp(b1 + b2*1 + (b3 + b4*1)*x + b6*0) )
x <- seq(-xlim, xlim, length = 500); Ylim <- 0.025
for(j in 1:3){
figure(lambda1 = lambda1[j], lambda0 = lambda0[j],
xlim = xlim, ylim = Ylim,
xlab = ifelse(i==3, T, F), ylab = ifelse(j==1, T, F))
text(x = -10, y = Ylim, adj = 0.5,
labels = paste0(Panel[i,j]," ", SP, ", ", Size[j], " (", Q.unscl.size[j], " mm)") )
}
}
mtext(text = "Distance (m)", 1, outer = T, line = 2)
mtext(text = "Probability density", 2, outer = T, line = 2.5)
dev.off()
# Script for figure 2
# Data and text ----
source("function_figure.R")
dat <- read.csv("data/VectorData_MERGE2019-11-19.csv")
Panel <- rbind( c("(a)", "(b)", "(c)"),
c("(d)", "(e)", "(f)"),
c("(g)", "(h)", "(i)") )
Size <- c("Small", "Median", "Large")
Species <- c("BHC", "CRC", "STJ")
xlim <- 350
# Plot ----
pdf("figure_dispersal_Todd_ver2.pdf", 6, 6)
par(mfrow = c(3, 3), mar = c(1,2,1,0), oma=c(5,5,2,1))
for(i in 1:3){
# Select species
SP <- Species[i]
dd <- dat[dat$Species==SP,]
# Scale body size with mean 0 SD 0.5
scl.size <- scale(dd$Size1, scale = sd(dd$Size1)*2)
Q.scl.size <- quantile(scl.size, c(0.2,0.5,0.8), na.rm = T)
# Unscaled body size
Q.unscl.size <- quantile(dd$Size1, c(0.2,0.5,0.8), na.rm = T)
# parameters
est <- read.csv(paste0("result/summary_8000", SP, "2019-11-20Q99.csv") )
b1 <- est[which(est$X=="b[1]"),"X50."] # Intercept
b2 <- est[which(est$X=="b[2]"),"X50."] # Flow
b3 <- est[which(est$X=="b[3]"),"X50."] # Size
b4 <- est[which(est$X=="b[4]"),"X50."] # Flow*Size
b6 <- est[which(est$X=="b[6]"),"X50."] # Stream
# rate parameter
lambda0 <- sapply(Q.scl.size, function(x) 1/exp(b1 + b2*0 + (b3 + b4*0)*x + b6*1) ) # b6*1 Todd
lambda1 <- sapply(Q.scl.size, function(x) 1/exp(b1 + b2*1 + (b3 + b4*1)*x + b6*1) ) # b6*1 Todd
x <- seq(-xlim, xlim, length = 500); Ylim <- 0.025
for(j in 1:3){
figure(lambda1 = lambda1[j], lambda0 = lambda0[j],
xlim = xlim, ylim = Ylim,
xlab = ifelse(i==3, T, F), ylab = ifelse(j==1, T, F))
text(x = -10, y = Ylim, adj = 0.5,
labels = paste0(Panel[i,j]," ", SP, ", ", Size[j], " (", Q.unscl.size[j], " mm)") )
}
}
mtext(text = "Distance (m)", 1, outer = T, line = 2)
mtext(text = "Probability density", 2, outer = T, line = 2.5)
dev.off()
la,bda0
lambda0
lambda1
# Script for figure 2
# Data and text ----
source("function_figure.R")
dat <- read.csv("data/VectorData_MERGE2019-11-19.csv")
Panel <- rbind( c("(a)", "(b)", "(c)"),
c("(d)", "(e)", "(f)"),
c("(g)", "(h)", "(i)") )
Size <- c("Small", "Median", "Large")
Species <- c("BHC", "CRC", "STJ")
xlim <- 350
# Plot ----
pdf("figure_dispersal_Todd_ver2.pdf", 6, 6)
par(mfrow = c(3, 3), mar = c(1,2,1,0), oma=c(5,5,2,1))
for(i in 1:3){
# Select species
SP <- Species[i]
dd <- dat[dat$Species==SP,]
# Scale body size with mean 0 SD 0.5
scl.size <- scale(dd$Size1, scale = sd(dd$Size1)*2)
Q.scl.size <- quantile(scl.size, c(0.2,0.5,0.8), na.rm = T)
# Unscaled body size
Q.unscl.size <- quantile(dd$Size1, c(0.2,0.5,0.8), na.rm = T)
# parameters
est <- read.csv(paste0("result/summary_8000", SP, "2019-11-20Q99.csv") )
b1 <- est[which(est$X=="b[1]"),"X50."] # Intercept
b2 <- est[which(est$X=="b[2]"),"X50."] # Flow
b3 <- est[which(est$X=="b[3]"),"X50."] # Size
b4 <- est[which(est$X=="b[4]"),"X50."] # Flow*Size
b6 <- est[which(est$X=="b[6]"),"X50."] # Stream
# rate parameter
lambda0 <- sapply(Q.scl.size, function(x) 1/exp(b1 + b2*0 + (b3 + b4*0)*x + b6*1) ) # b6*1 Todd
lambda1 <- sapply(Q.scl.size, function(x) 1/exp(b1 + b2*1 + (b3 + b4*1)*x + b6*1) ) # b6*1 Todd
x <- seq(-xlim, xlim, length = 500); Ylim <- 0.035
for(j in 1:3){
figure(lambda1 = lambda1[j], lambda0 = lambda0[j],
xlim = xlim, ylim = Ylim,
xlab = ifelse(i==3, T, F), ylab = ifelse(j==1, T, F))
text(x = -10, y = Ylim, adj = 0.5,
labels = paste0(Panel[i,j]," ", SP, ", ", Size[j], " (", Q.unscl.size[j], " mm)") )
}
}
mtext(text = "Distance (m)", 1, outer = T, line = 2)
mtext(text = "Probability density", 2, outer = T, line = 2.5)
dev.off()
# Script for figure 2
# Data and text ----
source("function_figure.R")
dat <- read.csv("data/VectorData_MERGE2019-11-19.csv")
Panel <- rbind( c("(a)", "(b)", "(c)"),
c("(d)", "(e)", "(f)"),
c("(g)", "(h)", "(i)") )
Size <- c("Small", "Median", "Large")
Species <- c("BHC", "CRC", "STJ")
xlim <- 350
# Plot ----
pdf("figure_dispersal_Indian_ver2.pdf", 6, 6)
par(mfrow = c(3, 3), mar = c(1,2,1,0), oma=c(5,5,2,1))
for(i in 1:3){
# Select species
SP <- Species[i]
dd <- dat[dat$Species==SP,]
# Scale body size with mean 0 SD 0.5
scl.size <- scale(dd$Size1, scale = sd(dd$Size1)*2)
Q.scl.size <- quantile(scl.size, c(0.2,0.5,0.8), na.rm = T)
# Unscaled body size
Q.unscl.size <- quantile(dd$Size1, c(0.2,0.5,0.8), na.rm = T)
# parameters
est <- read.csv(paste0("result/summary_8000", SP, "2019-11-20Q99.csv") )
b1 <- est[which(est$X=="b[1]"),"X50."] # Intercept
b2 <- est[which(est$X=="b[2]"),"X50."] # Flow
b3 <- est[which(est$X=="b[3]"),"X50."] # Size
b4 <- est[which(est$X=="b[4]"),"X50."] # Flow*Size
b6 <- est[which(est$X=="b[6]"),"X50."] # Stream
# rate parameter
lambda0 <- sapply(Q.scl.size, function(x) 1/exp(b1 + b2*0 + (b3 + b4*0)*x + b6*0) )
lambda1 <- sapply(Q.scl.size, function(x) 1/exp(b1 + b2*1 + (b3 + b4*1)*x + b6*0) )
x <- seq(-xlim, xlim, length = 500); Ylim <- 0.030
for(j in 1:3){
figure(lambda1 = lambda1[j], lambda0 = lambda0[j],
xlim = xlim, ylim = Ylim,
xlab = ifelse(i==3, T, F), ylab = ifelse(j==1, T, F))
text(x = -10, y = Ylim, adj = 0.5,
labels = paste0(Panel[i,j]," ", SP, ", ", Size[j], " (", Q.unscl.size[j], " mm)") )
}
}
mtext(text = "Distance (m)", 1, outer = T, line = 2)
mtext(text = "Probability density", 2, outer = T, line = 2.5)
dev.off()
# Script for figure 2
# Data and text ----
source("function_figure.R")
dat <- read.csv("data/VectorData_MERGE2019-11-19.csv")
Panel <- rbind( c("(a)", "(b)", "(c)"),
c("(d)", "(e)", "(f)"),
c("(g)", "(h)", "(i)") )
Size <- c("Small", "Median", "Large")
Species <- c("BHC", "CRC", "STJ")
xlim <- 350
# Plot ----
pdf("figure_dispersal_Todd_ver2.pdf", 6, 6)
par(mfrow = c(3, 3), mar = c(1,2,1,0), oma=c(5,5,2,1))
for(i in 1:3){
# Select species
SP <- Species[i]
dd <- dat[dat$Species==SP,]
# Scale body size with mean 0 SD 0.5
scl.size <- scale(dd$Size1, scale = sd(dd$Size1)*2)
Q.scl.size <- quantile(scl.size, c(0.2,0.5,0.8), na.rm = T)
# Unscaled body size
Q.unscl.size <- quantile(dd$Size1, c(0.2,0.5,0.8), na.rm = T)
# parameters
est <- read.csv(paste0("result/summary_8000", SP, "2019-11-20Q99.csv") )
b1 <- est[which(est$X=="b[1]"),"X50."] # Intercept
b2 <- est[which(est$X=="b[2]"),"X50."] # Flow
b3 <- est[which(est$X=="b[3]"),"X50."] # Size
b4 <- est[which(est$X=="b[4]"),"X50."] # Flow*Size
b6 <- est[which(est$X=="b[6]"),"X50."] # Stream
# rate parameter
lambda0 <- sapply(Q.scl.size, function(x) 1/exp(b1 + b2*0 + (b3 + b4*0)*x + b6*1) ) # b6*1 Todd
lambda1 <- sapply(Q.scl.size, function(x) 1/exp(b1 + b2*1 + (b3 + b4*1)*x + b6*1) ) # b6*1 Todd
x <- seq(-xlim, xlim, length = 500); Ylim <- 0.030
for(j in 1:3){
figure(lambda1 = lambda1[j], lambda0 = lambda0[j],
xlim = xlim, ylim = Ylim,
xlab = ifelse(i==3, T, F), ylab = ifelse(j==1, T, F))
text(x = -10, y = Ylim, adj = 0.5,
labels = paste0(Panel[i,j]," ", SP, ", ", Size[j], " (", Q.unscl.size[j], " mm)") )
}
}
mtext(text = "Distance (m)", 1, outer = T, line = 2)
mtext(text = "Probability density", 2, outer = T, line = 2.5)
dev.off()
# Select Species
SP <- "STJ"
# Data
dat <- read.csv("data/VectorData_MERGE2019-11-19.csv")
dd <- dat[dat$Species==SP,]
scl.size <- scale(dd$Size1, scale = 2*sd(dd$Size1))
Qsize <- quantile(scl.size, c(0.2,0.5,0.8), na.rm = T)
est <- read.csv(paste0("result/summary_8000", SP, "2019-11-20Q99.csv") )
b1id <- which(est$X=="b[1]") # Intercept
b2id <- which(est$X=="b[2]") # Flow
b3id <- which(est$X=="b[3]") # Size
b4id <- which(est$X=="b[4]") # Flow*Size
delta0 <- sapply(Qsize, function(x) exp(est[b1id,"X50."] + est[b3id,"X50."]*x) )
delta1 <- sapply(Qsize, function(x) exp(est[b1id,"X50."] + est[b2id,"X50."] + (est[b3id,"X50."] + est[b4id,"X50."])*x) )
delta0 <- 1/lambda0
delta1 <- 1/lambda1
var0 <- 2*delta0^2
var1 <- 2*delta1^2
# Select Species
SP <- "STJ"
# Data
dat <- read.csv("data/VectorData_MERGE2019-11-19.csv")
dd <- dat[dat$Species==SP,]
scl.size <- scale(dd$Size1, scale = 2*sd(dd$Size1))
Qsize <- quantile(scl.size, c(0.2,0.5,0.8), na.rm = T)
est <- read.csv(paste0("result/summary_8000", SP, "2019-11-20Q99.csv") )
b1id <- which(est$X=="b[1]") # Intercept
b2id <- which(est$X=="b[2]") # Flow
b3id <- which(est$X=="b[3]") # Size
b4id <- which(est$X=="b[4]") # Flow*Size
delta0 <- sapply(Qsize, function(x) exp(est[b1id,"X50."] + est[b3id,"X50."]*x) )
delta1 <- sapply(Qsize, function(x) exp(est[b1id,"X50."] + est[b2id,"X50."] + (est[b3id,"X50."] + est[b4id,"X50."])*x) )
var0 <- 2*delta0^2
var1 <- 2*delta1^2
delta0
delta1
help("julian")
julian(as.date(1970-1-1))
julian(as.Date(1970-1-1))
julian.Date("1/10/2016")
julian.Date(as.Date("1/10/2016"))
as.Date("1/10/2016")
as.Date("1-10-2016")
as.Date("1/10/2016")
as.Date(2016/1/10)
as.Date("2016/1/10")
julian.Date(as.Date("2016/1/10"))
julian(as.Date("2016/1/10"))
dat2
# Basic statistics
# Library ----
rm(list = ls(all.names = TRUE))
library(stringr)
# Function ----
fmr <- function(dat){
Mark_u <- tapply(dat$IND_ID, dat$Species, function(x) length(unique(x) ) )
Recap_u <- tapply(dat$IND_ID[dat$Y==1], dat$Species[dat$Y==1],
function(x) length(unique(x) ) )
Mark_repl <- tapply(dat$IND_ID, dat$Species, function(x) length(x) )
Recap_repl <- tapply(dat$IND_ID[dat$Y==1], dat$Species[dat$Y==1],
function(x) length(x) )
return(list(Mark_u = Mark_u, Recap_u = Recap_u,
Mark_repl = Mark_repl, Recap_repl = Recap_repl) )
}
# Data ----
# Fish data
dat <- read.csv("data/VectorData_MERGE2019-11-19.csv")
dat1 <- fmr(dat[dat$Stream=="Indian",])
dat2 <- fmr(dat[dat$Stream=="Todd",])
dat2
dat2
dat1$Mark_u
cbind(dat1$Mark_u, dat1$Recap_u, dat1$Mark_repl, dat1$Recap_repl)
M <- M1 + M2
M1 <- cbind(dat1$Mark_u, dat1$Recap_u, dat1$Mark_repl, dat1$Recap_repl)
M2 <- cbind(dat2$Mark_u, dat2$Recap_u, dat2$Mark_repl, dat2$Recap_repl)
M <- M1 + M2
M
mtcars
M <- data.frame(M)
M
M1 <- data.frame(dat1$Mark_u, dat1$Recap_u, dat1$Mark_repl, dat1$Recap_repl)
M2 <- data.frame(dat2$Mark_u, dat2$Recap_u, dat2$Mark_repl, dat2$Recap_repl)
M1
# Script for figure S1-3
# Library ----
rm(list = ls(all.names = TRUE))
library(stringr)
# Data ----
# Fish data
dat <- read.csv("data/VectorData_MERGE2019-11-19.csv")
dat$St_Month <- as.numeric(format(as.Date(dat$Date1), format = "%m") )
dat$St_Year <- format(as.Date(dat$Date1), format = "%Y")
dat$End_Month <- as.numeric(format(as.Date(dat$Date2), format = "%m") )
dat$End_Year <- format(as.Date(dat$Date2), format = "%Y")
## Movement distance
dat$X_m <- (dat$X2-dat$X1)*20
SP <- sort(unique(dat$Species) )
M2 <- data.frame(dat2$Mark_u, dat2$Recap_u, dat2$Mark_repl, dat2$Recap_repl)
SP
# Data merge
rm(list = ls(all.names = TRUE))
Species <- c("BHC", "CRC", "STJ")
file <- sapply(1:3, function(x)paste0("data/VectorData_", Species[x], "2019-11-19.csv"))
dat_raw <- rbind(read.csv(file[1]), read.csv(file[2]), read.csv(file[3]) )
## Remove odd replicates
y <- dat_raw$Size2-dat_raw$Size1
y
which(y %in% c(-29,100))
range(y, na.rm = T)
table(y)
t(table(y))
table(y)
plot(table(y))
source('C:/Users/a_terui/OneDrive - UNCG/Documents/GitHub/SC_dispersal_project/datasort_environment_ver2.R')
FLOW_I
mean(FLOW_I)
mean(unlist(FLOW_I))
## Median flow
### Median water level
Q50_Indian <- unlist(lapply(FLOW_I, function(x) mean(x-mean(unlist(FLOW_I))) ) )
Q50_Indian
scale(Q50_Indian)
Q50_Indian <- unlist(lapply(FLOW_I, function(x) mean(x-mean(unlist(FLOW_I))) ) )
Q50_Todd <- unlist(lapply(FLOW_T, function(x) mean(x-mean(unlist(FLOW_T))) ) )
Q50 <- cbind(Q50_Indian, Q50_Todd)
Q50
Q50*10
read.csv("WAIC_summary.csv")
read.csv("result/WAIC_summary.csv")
M4 <- read.csv("result/Est_MedFlowModel.csv")
M4
round(M4, 2)
M4 <- read.csv("result/Est_MedFlowModel.csv")
M4[which(M4$Effect == mu.phi), "Effect"] <-
kable(M4)
M4 <- read.csv("result/Est_MedFlowModel.csv")
colnames(M4) <- c("Species", "Effect", "Estimate", "Lower 95% CI", "Upper 95% CI")
M4[,3:5] <- round(M4[,3:5], 2)
M4[which(M4$Effect == mu.phi), "Effect"] <-
a
M4
M4[which(M4$Effect == mu.phi), "Effect"]
M4[which(M4$Effect == "mu.phi"), "Effect"]
M4[which(M4$Effect == "mu.phi"), "Effect"] <- "$\\mu_{\\phi}$"
M4$Effect <- as.character(M4$Effect)
M4 <- read.csv("result/Est_MedFlowModel.csv")
M4$Effect <- as.character(M4$Effect)
colnames(M4) <- c("Species", "Effect", "Estimate", "Lower 95% CI", "Upper 95% CI")
M4[,3:5] <- round(M4[,3:5], 2)
M4[which(M4$Effect == "mu.phi"), "Effect"] <- "$\\mu_{\\phi}$"
# Data for figure S1-3
# Library ----
rm(list = ls(all.names = TRUE))
library(stringr)
# Data ----
# Fish data
dat <- read.csv("data/VectorData_MERGE2019-11-19.csv")
dat$St_Month <- as.numeric(format(as.Date(dat$Date1), format = "%m") )
dat$St_Year <- format(as.Date(dat$Date1), format = "%Y")
dat$End_Month <- as.numeric(format(as.Date(dat$Date2), format = "%m") )
dat$End_Year <- format(as.Date(dat$Date2), format = "%Y")
## Movement distance
dat$X_m <- (dat$X2-dat$X1)*20
SP <- sort(unique(dat$Species) )
# Env data
QF99 <- read.csv("data/Env_QF99_2019-11-19.csv")
Q99 <- cbind(QF99$QF99_Indian, QF99$QF99_Todd)
Str <- ifelse(dat$Stream=="Indian", 1, 2)
dat$QF99 <- Q99[cbind(dat$Occasion1, Str)]
dat$Q99 <- ifelse(dat$QF99 > 0, 1, 0)
View(dat)
Q99
Str
QF99
help(kable)
# Call library ----
rm(list = ls(all.names = TRUE))
library(stringr)
# Select species ----
species <- "BHC" #MTS, CRC, BHC, STJ
# Data ----
## Define data source
d1 <- read.csv("data/Indian_final.csv"); d1 <- d1[,1:which(colnames(d1)=="COMMENTS")]; d1$Stream <- "Indian"
d2 <- read.csv("data/Todd_final.csv"); d2 <- d2[,1:which(colnames(d2)=="COMMENTS")]; d2$Stream <- "Todd"
dat <- rbind(d1, d2)
## Re-define
dat$Year <- str_sub(dat$Date, start = 1, end = 4)
dat$Month <- str_sub(dat$Date, start = 5, end = 6)
dat$Day <- str_sub(dat$Date, start = 7, end = 8)
dat$as.date <- as.Date(paste(dat$Year,dat$Month,dat$Day, sep="/"))
# Data sort ----
## remove 1-2 occasions; these are trial period so inappropriate for analysis
dat$Occasion <- dat$Occasion - 2
dat <- dat[dat$Occasion > 0,]
## remove individuals with no body size data
dat <- dat[-which(is.na(dat$LEN_COR)),]
## remove inidividuals capture only at the last occasion
ID_last <- unique(dat$TAGID[dat$Occasion==max(dat$Occasion)])
ID_single <- names(which(table(dat$TAGID)==1) )
ID_rm <- intersect(ID_last, ID_single)
dat <- dat[-which(dat$TAGID %in% ID_rm),]
## Remove data without tag info
dat <- dat[-which(is.na(dat$TAGID)),]
## Select species
D <- dat[dat$SPE == species,]; unique(D$SPE)
## Matrix data
### Msize, Msec, Mdate
indID <- sort( unique(D$TAGID) ) # individual tagID
occID <- sort( unique(D$Occasion) ) # occasionID
Mcap <- Msize <- Msec <- Mjd <- Mdate <- matrix(nrow = length(indID), ncol = length(occID))
Str <- NULL
for(i in 1:length(indID) ){
tmp <- D[D$TAGID == indID[i],]
for(j in 1:nrow(tmp)){
Msec[i,tmp$Occasion[j]] <- tmp$SEC[j] #Section ID
Msize[i,tmp$Occasion[j]] <- tmp$LEN_COR[j] #Body size
Mjd[i,tmp$Occasion[j]] <- julian.Date(tmp$as.date[j]) #Julian date
Mdate[i,tmp$Occasion[j]] <- as.character(tmp$as.date[j]) #Date
}
Str[i] <- unique(tmp$Stream)
print(substitute(var1/var2, list(var1 = i, var2 = length(indID)) ) )
}
# Recap data ----
source("function_getY_binary.R")
MY <- getY_binary(Msec)
X1ID <- X2ID <- which(is.na(MY)==0, arr.ind = T)
X1ID[,2] <- X2ID[,2] - 1
View(MY)
indID
D
tmp
# Recap data ----
source("function_getY_binary.R")
MY <- getY_binary(Msec)
X1ID <- X2ID <- which(is.na(MY)==0, arr.ind = T)
X1ID[,2] <- X2ID[,2] - 1
# Vectorize output
out <- data.frame(ID = 1:length(MY[is.na(MY)==0]))
### Species
out$Species <- species
### Stream
out$Stream <- Str[X1ID[,1]]
### Recap or not
out$Y <- MY[is.na(MY)==0]
### Release and recapture location
out$X1 <- Msec[X1ID]
out$X2 <- Msec[X2ID]
### Body size
out$Size1 <- Msize[X1ID]
out$Size2 <- Msize[X2ID]
### Julian date
out$JD1 <- Mjd[X1ID]
out$JD2 <- Mjd[X2ID]
### Date
out$Date1 <- Mdate[X1ID]
out$Date2 <- Mdate[X2ID]
### Occasion ID
out$Occasion1 <- X1ID[,2]
out$Occasion2 <- X2ID[,2]
### Individual ID
out$IND_ID <- X1ID[,1]
### Tag ID
out$TAG_ID <- indID[X1ID[,1]]
View(X1ID)
View(X2ID)
tmp
occID
MY
mean(X1ID[1,]==X2ID[2,])
mean(X1ID[1,]==X2ID[1,])
mean(X1ID[,1]==X2ID[,1])
View(Msec)
Msec
is.na(Msec[,1])
ifelse(is.na(Msec[,1]), NA, 1)
ncol(Msec)
M <- matrix(rbinom(25,1,0.5), 5, 5)
M
M[M==0] <- NA
M
getY_binary(M)
sum(is.na(MY[,1]))
Msec[,MY[,14]==1]
View(Msec[which(MY[,14]==1),])
View(Msec[which(MY[,14]==0),])
Str[X1ID[,1]]
MY[is.na(MY)==0]
View(out)
Msec[1,]
Msec[108,]
Msec[1,]
out$X2[out$Y==0]
sum(is.na(out$X2[out$Y==0]))
length(is.na(out$X2[out$Y==0]))
length(is.na(out$X2[out$Y==1]))
sum(is.na(out$X2[out$Y==1]))
is.na(out$X2[out$Y==1])
out$X2[out$Y==1]
